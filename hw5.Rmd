---
title: "Homework 5"
author: "Andy Turner"
date: "2023-11-08"
output: github_document
---

```{r}
library(tidyverse)
```


## Problem 1 

Reading in the homicide datafile. 
```{r setup, include=FALSE}
homicide = read.csv("data/homicide-data.csv")
```

**Description of raw data**

The data includes information on `nrow(homicide)` criminal homicides over the past decade in 50 of the largest American cities. The data included the location of the killing, whether an arrest was made and, in most cases, basic demographic information about each victim. Overall there are `ncol(homicide)` variables in the dataset. 

```{r}
homicide = 
  homicide |> 
  mutate(city_state = paste(city, state, sep = ", ")
)

baltimore_df=
  homicide |> 
  filter(city == "Baltimore") |> 
  mutate(
    resolved= as.numeric(disposition == "Closed by arrest"),
    victim_age= as.numeric(victim_age)
  ) |> 
  select(resolved, victim_age, victim_race, victim_sex)

```

Logistic Regression

```{r}
fit_logistic=
  baltimore_df |> 
  glm(
    resolved ~ victim_age + victim_race + victim_sex, 
    data = _, 
    family = binomial())
  )
```

Look at the results
```{r}
fit_logistic |> 
  broom::tidy() |> 
  mutate(OR= exp(estimate)) |> 
  select(term, estimate, OR)
```

## Problem 2

```{r}
take2 <- list.files("data1/", pattern = "\\.csv$", full.names = FALSE) |> 
  as.data.frame() |> 
  setNames("file_path")
 

```


